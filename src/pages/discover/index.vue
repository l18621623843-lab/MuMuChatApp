<script lang="ts" setup>
definePage({
  style: {
    navigationStyle: 'custom',
    navigationBarTitleText: '%tabbar.discover%',
  },
})

const _sys = uni.getSystemInfoSync()
const headerPadTop = Math.max((_sys.safeAreaInsets && _sys.safeAreaInsets.top) || 0, _sys.statusBarHeight || 0) + 44

const mainSettings = [
  { id: 1, title: 'è´¦å·', subtitle: 'è´¦å·ã€ç”¨æˆ·åã€ä¸ªäººç®€ä»‹', icon: 'ğŸ‘¤', color: '#5ab0ff' },
  { id: 2, title: 'èŠå¤©è®¾ç½®', subtitle: 'å£çº¸ã€æ·±è‰²æ¨¡å¼ã€åŠ¨ç”»æ•ˆæœ', icon: 'ğŸ’¬', color: '#f0a045' },
  { id: 3, title: 'éšç§ä¸å®‰å…¨', subtitle: 'æœ€åä¸Šçº¿æ—¶é—´ã€ç™»å½•è®¾å¤‡ã€é€šè¡Œå¯†é’¥', icon: 'ğŸ›¡ï¸', color: '#4cd964' },
  { id: 4, title: 'é€šçŸ¥', subtitle: 'å£°éŸ³ã€é€šè¯ã€æ ‡è®°', icon: 'ğŸ””', color: '#ff6b6b' },
  { id: 5, title: 'æ•°æ®å’Œå‚¨å­˜', subtitle: 'åª’ä½“ä¸‹è½½è®¾ç½®', icon: 'ğŸ’¾', color: '#4ea3ff' },
  { id: 6, title: 'èŠå¤©æ–‡ä»¶å¤¹', subtitle: 'å°†èŠå¤©åˆ†ç±»åˆ°æ–‡ä»¶å¤¹ä¸­', icon: 'ğŸ“', color: '#4ea3ff' },
  { id: 7, title: 'è®¾å¤‡', subtitle: 'ç®¡ç†å·²è¿æ¥çš„è®¾å¤‡', icon: 'ğŸ–¥ï¸', color: '#4ea3ff' },
  { id: 8, title: 'çœç”µ', subtitle: 'ä½ç”µé‡æ—¶é™ä½åŠŸè€—', icon: 'ğŸ”‹', color: '#f5a623' },
  { id: 9, title: 'è¯­è¨€', subtitle: 'ç®€ä½“ä¸­æ–‡ @zh_CN', icon: 'ğŸŒ', color: '#8e8e93' },
]

const premiumSettings = [
  { id: 1, title: 'Telegram å¤§ä¼šå‘˜', icon: 'â­', color: '#8e6fff' },
  { id: 2, title: 'Telegram æ˜Ÿæ˜Ÿ', icon: 'ğŸŒŸ', color: '#ffb300' },
  { id: 3, title: 'æˆ‘çš„ TON', icon: 'ğŸ’', color: '#3aa3ff' },
  { id: 4, title: 'Telegram ä¼ä¸šç‰ˆ', icon: 'ğŸ¢', color: '#ff9f43' },
  { id: 5, title: 'å‘é€ç¤¼ç‰©', icon: 'ğŸ', color: '#ff6b6b' },
]

const helpSettings = [
  { id: 1, title: 'å¸®åŠ©', icon: 'â„¹ï¸', color: '#5ab0ff' },
  { id: 2, title: 'å‘æˆ‘ä»¬æé—®', icon: 'ğŸ’¬', color: '#f0a045' },
  { id: 3, title: 'å¸¸è§é—®é¢˜', icon: 'â“', color: '#4ea3ff' },
  { id: 4, title: 'Telegram æ–°åŠŸèƒ½', icon: 'ğŸ†•', color: '#4cd964' },
  { id: 5, title: 'éšç§æ”¿ç­–', icon: 'âœ…', color: '#2ecc71' },
]

function openSettings(key: string, title: string) {
  uni.navigateTo({ url: `/pages/settings/detail?key=${encodeURIComponent(key)}&title=${encodeURIComponent(title)}` })
}

function tapMain(item: { title: string }) {
  const map: Record<string, string> = {
    è´¦å·: 'account',
    èŠå¤©è®¾ç½®: 'chat',
    éšç§ä¸å®‰å…¨: 'privacy',
    é€šçŸ¥: 'notifications',
    æ•°æ®å’Œå‚¨å­˜: 'data',
    è®¾å¤‡: 'devices',
    è¯­è¨€: 'language',
  }
  openSettings(map[item.title] || 'account', item.title)
}

function tapHelp(item: { title: string }) {
  if (item.title === 'å¸®åŠ©' || item.title === 'å‘æˆ‘ä»¬æé—®' || item.title === 'å¸¸è§é—®é¢˜' || item.title === 'Telegram æ–°åŠŸèƒ½')
    openSettings('help', item.title)
  else
    uni.showToast({ title: `${item.title}ï¼ˆæ¨¡æ‹Ÿï¼‰`, icon: 'none' })
}

function toastSim(title: string) {
  uni.showToast({ title: `${title}ï¼ˆæ¨¡æ‹Ÿï¼‰`, icon: 'none' })
}
</script>

<template>
  <view class="min-h-screen flex flex-col bg-#f2f2f2">
    <view class="fixed left-0 right-0 top-0 z-1000 bg-#f2f2f2 pt-safe">
      <view class="h-44px flex items-center justify-between px-4">
        <text class="text-18px text-#111 font-600">è®¾ç½®</text>
        <view class="flex items-center gap-3 text-18px text-#444">
          <text>ğŸ”</text>
          <text>â‹®</text>
        </view>
      </view>
      <view class="h-1px bg-#e6e6e6" />
    </view>

    <scroll-view class="no-bounce flex-1" :style="{ paddingTop: `${headerPadTop}px` }" scroll-y>
      <view class="px-4 pt-3">
        <view class="overflow-hidden rounded-16px bg-white">
          <view
            v-for="(item, idx) in mainSettings"
            :key="item.id"
            class="flex items-center gap-3 px-4 py-3 transition-colors active:bg-#f5f5f5"
            :class="idx === mainSettings.length - 1 ? '' : 'border-b-1 border-#ededed'"
            @click="tapMain(item)"
          >
            <view class="h-40px w-40px flex items-center justify-center rounded-12px text-16px text-white" :style="{ backgroundColor: item.color }">
              {{ item.icon }}
            </view>
            <view class="min-w-0 flex flex-1 flex-col gap-1">
              <text class="truncate text-15px text-#1f1f1f font-600">{{ item.title }}</text>
              <text class="truncate text-12px text-#9b9b9b">{{ item.subtitle }}</text>
            </view>
          </view>
        </view>

        <view class="mt-3 overflow-hidden rounded-16px bg-white">
          <view
            v-for="(item, idx) in premiumSettings"
            :key="item.id"
            class="flex items-center gap-3 px-4 py-3 transition-colors active:bg-#f5f5f5"
            :class="idx === premiumSettings.length - 1 ? '' : 'border-b-1 border-#ededed'"
            @click="toastSim(item.title)"
          >
            <view class="h-40px w-40px flex items-center justify-center rounded-12px text-16px text-white" :style="{ backgroundColor: item.color }">
              {{ item.icon }}
            </view>
            <text class="text-15px text-#1f1f1f font-600">{{ item.title }}</text>
          </view>
        </view>

        <view class="mt-3 overflow-hidden rounded-16px bg-white">
          <view
            v-for="(item, idx) in helpSettings"
            :key="item.id"
            class="flex items-center gap-3 px-4 py-3 transition-colors active:bg-#f5f5f5"
            :class="idx === helpSettings.length - 1 ? '' : 'border-b-1 border-#ededed'"
            @click="tapHelp(item)"
          >
            <view class="h-40px w-40px flex items-center justify-center rounded-12px text-16px text-white" :style="{ backgroundColor: item.color }">
              {{ item.icon }}
            </view>
            <text class="text-15px text-#1f1f1f font-600">{{ item.title }}</text>
          </view>
        </view>

        <view class="pb-90px pt-6 text-center text-11px text-#b0b0b0">
          Telegram Android å®¢æˆ·ç«¯ v12.4 / (65) / 0<br>direct arm64-v8a
        </view>
      </view>
    </scroll-view>
  </view>
</template>
